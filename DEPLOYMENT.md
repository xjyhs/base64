# 多域名部署指南

本项目支持将 `base64-image.com` 和 `base64-pdf.com` 分别指向对应的工具页面。

## 部署方案

### 单一应用多域名路由

使用一个 Next.js 应用，通过中间件和路由配置实现多域名访问。

#### 优势
- 代码统一管理
- 静态文件共享
- 部署简单
- 维护成本低

#### 配置说明

1. **Next.js 配置** (`next.config.mjs`)
   - 添加了 `rewrites` 规则处理不同域名的路由
   - 支持多域名访问同一应用

2. **中间件配置** (`middleware.ts`)
   - 检测访问的域名
   - 自动重定向到对应的工具页面
   - 保持国际化功能

## 部署步骤

### 1. 本地开发测试

```bash
# 安装依赖
pnpm install

# 本地开发
pnpm dev

# 构建测试
pnpm build
pnpm start
```

### 2. 生产环境部署

```bash
# 构建应用
pnpm build

# 启动应用
pnpm start
```

### 3. 域名配置

在 DNS 服务商处配置：
- `base64-image.com` A 记录指向服务器 IP
- `base64-pdf.com` A 记录指向服务器 IP
- `www.base64-image.com` CNAME 指向 `base64-image.com`
- `www.base64-pdf.com` CNAME 指向 `base64-pdf.com`

## 静态文件处理

### 静态资源优化
- 使用 Next.js 内置的静态文件优化
- 启用自动代码分割和懒加载
- 图片优化和懒加载

### 构建优化
- 启用 Tree Shaking
- 代码分割和懒加载
- 压缩和优化输出

## 部署平台选择

### 1. Vercel（推荐）
- 原生支持 Next.js
- 自动处理多域名配置
- 内置 CDN 和缓存优化
- 简单的域名绑定

```bash
# 使用 Vercel CLI 部署
npx vercel
```

### 2. Netlify
- 支持 Next.js 应用
- 自动构建和部署
- 域名管理功能

### 3. 传统服务器
- 使用 PM2 进程管理
- 配置反向代理（如 Nginx）
- 手动处理 SSL 证书

## 域名访问逻辑

### 访问流程
1. 用户访问 `base64-image.com`
2. 中间件检测域名
3. 自动重定向到 `/zh/tools/base64-image`
4. 显示对应的工具页面

### 语言切换
- 默认显示中文版本
- 访问 `/en` 路径显示英文版本
- 保持用户语言偏好

## 监控和维护

### 性能监控
- 使用 Next.js 内置的性能监控
- 配置 Google Analytics
- 监控页面加载速度

### 日志记录
- 使用 Next.js 内置日志
- 监控错误和异常
- 记录用户访问统计

## 故障排除

### 域名访问问题
- 检查 DNS 配置
- 验证中间件逻辑
- 确认路由配置

### 静态文件加载问题
- 检查构建输出
- 验证静态文件路径
- 查看浏览器网络请求

## 扩展方案

### 添加新域名
1. 在 `next.config.mjs` 中添加新的 rewrite 规则
2. 在 `middleware.ts` 中添加域名检测逻辑
3. 配置 DNS 记录

### 独立应用部署
如果需要完全独立的应用：
1. 复制项目为每个域名创建独立副本
2. 移除不需要的工具页面
3. 优化构建大小
4. 独立部署和维护

## 性能优化建议

### 1. CDN 配置
- 使用 CDN 加速静态资源
- 配置合适的缓存策略
- 启用 HTTP/2

### 2. 缓存策略
- 浏览器缓存
- Next.js 自动缓存
- 静态资源长期缓存

### 3. 代码优化
- 组件懒加载
- 图片优化
- 减少包大小
- 使用 Next.js Image 组件 