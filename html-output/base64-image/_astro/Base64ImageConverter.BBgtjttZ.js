import{r as le,a as l}from"./index._OACqPSs.js";var O={exports:{}},j={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var q;function de(){if(q)return j;q=1;var s=le(),t=Symbol.for("react.element"),i=Symbol.for("react.fragment"),a=Object.prototype.hasOwnProperty,n=s.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,c={key:!0,ref:!0,__self:!0,__source:!0};function h(b,d,x){var u,m={},k=null,p=null;x!==void 0&&(k=""+x),d.key!==void 0&&(k=""+d.key),d.ref!==void 0&&(p=d.ref);for(u in d)a.call(d,u)&&!c.hasOwnProperty(u)&&(m[u]=d[u]);if(b&&b.defaultProps)for(u in d=b.defaultProps,d)m[u]===void 0&&(m[u]=d[u]);return{$$typeof:t,type:b,key:k,ref:p,props:m,_owner:n.current}}return j.Fragment=i,j.jsx=h,j.jsxs=h,j}var J;function ce(){return J||(J=1,O.exports=de()),O.exports}var e=ce();class ge{worker=null;tasks=new Map;isReady=!1;initPromise=null;isClient=!1;constructor(){this.isClient=typeof window<"u"&&typeof Worker<"u",this.isClient&&this.initWorker()}async initWorker(){if(!this.isClient)throw new Error("Worker is not available in this environment");return this.initPromise?this.initPromise:(this.initPromise=new Promise((t,i)=>{try{this.worker=new Worker("./base64-worker.js"),this.worker.onmessage=a=>{const{type:n,id:c,result:h,error:b,progress:d,message:x}=a.data;switch(n){case"ready":this.isReady=!0,t();break;case"result":this.handleResult(c,h);break;case"error":this.handleError(c,b);break;case"progress":this.handleProgress(c,d,x);break;default:console.warn("Unknown worker message type:",n)}},this.worker.onerror=a=>{console.error("Worker error:",a),i(new Error("Worker initialization failed"))}}catch(a){i(a)}}),this.initPromise)}handleResult(t,i){const a=this.tasks.get(t);a&&(this.tasks.delete(t),a.resolve(i))}handleError(t,i){const a=this.tasks.get(t);a&&(this.tasks.delete(t),a.reject(new Error(i)))}handleProgress(t,i,a){const n=this.tasks.get(t);n&&n.onProgress&&n.onProgress(i,a)}generateTaskId(){return Date.now().toString(36)+Math.random().toString(36).substr(2)}async ensureWorkerReady(){if(!this.isClient)throw new Error("Worker is not available in this environment");this.isReady||await this.initWorker()}async base64ToBlob(t,i){return this.isClient?(await this.ensureWorkerReady(),new Promise((a,n)=>{const c=this.generateTaskId();this.tasks.set(c,{id:c,type:"base64ToBlob",resolve:a,reject:n,onProgress:i}),this.worker.postMessage({type:"base64ToBlob",id:c,data:{base64:t}})})):{success:!1,error:"Worker not available in this environment"}}async fileToBase64(t,i){return this.isClient?(await this.ensureWorkerReady(),new Promise((a,n)=>{const c=this.generateTaskId();this.tasks.set(c,{id:c,type:"fileToBase64",resolve:a,reject:n,onProgress:i}),this.worker.postMessage({type:"fileToBase64",id:c,data:{file:t}})})):{success:!1,error:"Worker not available in this environment"}}async validateBase64Image(t){return this.isClient?(await this.ensureWorkerReady(),new Promise((i,a)=>{const n=this.generateTaskId();this.tasks.set(n,{id:n,type:"validateBase64",resolve:i,reject:a}),this.worker.postMessage({type:"validateBase64",id:n,data:{base64:t}})})):{success:!1,error:"Worker not available in this environment"}}destroy(){this.worker&&(this.worker.terminate(),this.worker=null),this.tasks.clear(),this.isReady=!1,this.initPromise=null}}const _=new ge,ue=(s,t)=>{const[i,a]=l.useState(s);return l.useEffect(()=>{const n=setTimeout(()=>{a(s)},t);return()=>{clearTimeout(n)}},[s,t]),i};class he{translations=null;isClient=!1;fallbackTranslations=null;isReady=!1;readyCallbacks=[];constructor(){this.fallbackTranslations={converter:{tabs:{decode:"Base64 to Image",encode:"Image to Base64"},actions:{paste:"Paste Base64 encoding here...",decode:"Convert to Image",clear:"Clear",copy:"Copy",downloadImage:"Download Image",downloadTxt:"Download as TXT"},labels:{dropzone:"Drag and drop image here, or click to select file",resultTitle:"Conversion Result",outputTitle:"Base64 Output",loading:"Processing..."},textStats:{length:"Length",size:"Size",largeTextWarning:"Large text detected, processing may take some time"},messages:{errorPaste:"Please enter Base64 encoding",errorInvalid:"Please enter a valid image Base64 encoding",success:"Conversion successful!",errorFail:"Conversion failed: ",errorSelect:"Please select an image file",errorSize:"File size cannot exceed 10MB",errorUnknown:"Conversion failed",imageDownloaded:"Image downloaded",copied:"Base64 encoding copied to clipboard",copyFail:"Copy failed, please select and copy manually",textDownloaded:"Base64 file downloaded",cleared:"Cleared all results",processing:"Processing text...",textProcessed:"Text processed successfully"}}}}init(){typeof window<"u"?(this.isClient=!0,window.translations?(this.translations=window.translations,this.isReady=!0,this.notifyReady()):setTimeout(()=>{window.translations?(this.translations=window.translations,this.isReady=!0,this.notifyReady()):setTimeout(()=>{window.translations||(this.translations=this.fallbackTranslations,this.isReady=!0,this.notifyReady())},100)},0)):(this.translations=this.fallbackTranslations,this.isReady=!0)}notifyReady(){this.readyCallbacks.forEach(t=>t()),this.readyCallbacks=[]}onReady(t){this.isReady?t():this.readyCallbacks.push(t)}t(t){if(!this.translations)return t;const i=t.split(".");let a=this.translations;for(const n of i)if(a&&typeof a=="object"&&n in a)a=a[n];else return t;return typeof a=="string"?a:t}isClientSide(){return this.isClient}}const C=new he,me=()=>{const[s,t]=l.useState(!1);return l.useEffect(()=>{C.init(),C.onReady(()=>{t(!0)})},[]),{t:C.t.bind(C),isReady:s,isClient:C.isClientSide()}};function fe(){const{t:s,isClient:t}=me(),[i,a]=l.useState("decode"),[n,c]=l.useState(""),[h,b]=l.useState(""),[d,x]=l.useState(""),[u,m]=l.useState(!1),[k,p]=l.useState(!1),[R,E]=l.useState(null),[N,W]=l.useState({show:!1,progress:0,message:""}),[y,B]=l.useState(null),[S,I]=l.useState(!1),[w,K]=l.useState(null),L=l.useRef(null),D=l.useRef(null),A=l.useRef(null),V=ue(n,300),M=l.useMemo(()=>{if(!n)return null;const r=n.length,o=Math.round(r*.75/1024*100)/100,f=r>5e4;return{length:r,sizeKB:o,isLarge:f}},[V]);l.useEffect(()=>{K(M)},[M]),l.useEffect(()=>()=>{_.destroy()},[]);const g=(r,o="info")=>{E({message:r,type:o}),setTimeout(()=>E(null),3e3)},z=(r,o)=>{W({show:!0,progress:Math.min(100,Math.max(0,r)),message:o})},P=()=>{W({show:!1,progress:0,message:""})},F=()=>{if(D.current){const f=D.current.getBoundingClientRect().top+window.pageYOffset+-80;window.scrollTo({top:f,behavior:"smooth"})}},X=l.useCallback(r=>{const o=r.target.value;o.length>5e4?(I(!0),setTimeout(()=>{c(o),I(!1)},0)):c(o)},[]),Y=l.useCallback(r=>{const o=r.clipboardData.getData("text");o.length>1e5&&(r.preventDefault(),I(!0),g(s("converter.messages.processing"),"info"),(async()=>{try{let $="";for(let T=0;T<o.length;T+=5e4){const oe=o.slice(T,T+5e4);$+=oe,await new Promise(ie=>setTimeout(ie,10));const ne=Math.round(T/o.length*100);z(ne,s("converter.messages.processing"))}c($),P(),g(s("converter.messages.textProcessed"),"success")}catch{g(s("converter.messages.errorUnknown"),"error"),P()}finally{I(!1)}})())},[s]),H=l.useCallback(async()=>{if(!n.trim()){g(s("converter.messages.errorPaste"),"error");return}m(!0),B(null);try{const r=await _.base64ToBlob(n,z);r.success&&r.url?(x(r.url),r.size&&B({name:"converted-image",size:`${r.size.size} ${r.size.unit}`,type:r.type||"image/*"}),g(s("converter.messages.success"),"success"),setTimeout(F,100)):g(s("converter.messages.errorFail"),"error")}catch(r){g(s("converter.messages.errorFail")+r.message,"error")}finally{m(!1),P()}},[n]),U=l.useCallback(async r=>{if(!r.type.startsWith("image/")){g(s("converter.messages.errorSelect"),"error");return}if(r.size>100*1024*1024){g("文件过大，请选择小于100MB的图片","error");return}m(!0),B(null);try{const o=await _.fileToBase64(r,z);o.success&&o.data?(b(o.data),o.sizeInfo&&B({name:r.name,size:`${o.sizeInfo.size} ${o.sizeInfo.unit}`,type:r.type}),g(s("converter.messages.success"),"success"),setTimeout(F,100)):g(o.error||s("converter.messages.errorUnknown"),"error")}catch(o){g(s("converter.messages.errorFail")+o.message,"error")}finally{m(!1),P()}},[]),G=r=>{const o=r.target.files?.[0];o&&U(o)},Q=r=>{r.preventDefault(),p(!0)},Z=r=>{r.preventDefault(),p(!1)},ee=r=>{r.preventDefault(),p(!1);const o=r.dataTransfer.files[0];o&&U(o)},te=()=>{if(d&&y){const r=document.createElement("a");r.href=d,r.download=y.name+".png",document.body.appendChild(r),r.click(),document.body.removeChild(r),g(s("converter.messages.imageDownloaded"),"success")}},re=async()=>{const r=i==="encode"?h:n;if(r)try{await navigator.clipboard.writeText(r),g(s("converter.messages.copied"),"success")}catch{g(s("converter.messages.copyFail"),"error")}},se=()=>{const r=i==="encode"?h:n;if(r){const o=new Blob([r],{type:"text/plain"}),f=URL.createObjectURL(o),v=document.createElement("a");v.href=f,v.download="base64-data.txt",document.body.appendChild(v),v.click(),document.body.removeChild(v),URL.revokeObjectURL(f),g(s("converter.messages.textDownloaded"),"success")}};return e.jsxs("div",{className:"w-full max-w-4xl mx-auto p-4",ref:D,children:[e.jsx("style",{children:`
        [data-theme="dark"] .bg-white { background-color: rgb(31 41 55) !important; }
        [data-theme="dark"] .bg-gray-50 { background-color: rgb(55 65 81) !important; }
        [data-theme="dark"] .bg-gray-100 { background-color: rgb(55 65 81) !important; }
        [data-theme="dark"] .border-gray-200 { border-color: rgb(75 85 99) !important; }
        [data-theme="dark"] .border-gray-300 { border-color: rgb(75 85 99) !important; }
        [data-theme="dark"] .text-gray-900 { color: rgb(255 255 255) !important; }
        [data-theme="dark"] .text-gray-600 { color: rgb(156 163 175) !important; }
        [data-theme="dark"] .text-gray-700 { color: rgb(209 213 219) !important; }
        [data-theme="dark"] .hover\\:bg-gray-200:hover { background-color: rgb(75 85 99) !important; }
        [data-theme="dark"] .hover\\:border-gray-400:hover { border-color: rgb(107 114 128) !important; }
      `}),R&&e.jsx("div",{className:`
          fixed top-5 right-5 z-50 px-5 py-3 rounded-xl text-white font-medium text-sm
          shadow-2xl transition-all duration-300 ease-out
          ${R.type==="success"?"bg-green-500":R.type==="error"?"bg-red-500":"bg-blue-500"}
        `,children:R.message}),N.show&&e.jsxs("div",{className:"fixed top-5 left-1/2 transform -translate-x-1/2 z-50 bg-white dark:bg-gray-800 rounded-xl shadow-2xl p-4 border border-gray-200 dark:border-gray-700 min-w-80",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("div",{className:"w-4 h-4 border-2 border-blue-500 border-t-transparent rounded-full animate-spin"}),e.jsx("span",{className:"text-sm font-medium text-gray-800 dark:text-white",children:N.message})]}),e.jsx("div",{className:"w-full bg-gray-200 dark:bg-gray-700 rounded-full h-2",children:e.jsx("div",{className:"bg-blue-500 h-2 rounded-full transition-all duration-300",style:{width:`${Math.min(100,Math.max(0,N.progress))}%`}})}),e.jsxs("div",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1 text-right",children:[Math.round(N.progress),"%"]})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-2xl shadow-xl border border-gray-200 dark:border-gray-700 overflow-hidden",children:[e.jsxs("div",{className:"flex border-b border-gray-200 dark:border-gray-700",children:[e.jsx("button",{onClick:()=>a("decode"),className:`flex-1 p-4 text-lg font-semibold transition-colors duration-200 ${i==="decode"?"bg-blue-500 text-white":"bg-transparent text-gray-600 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700"}`,children:t?s("converter.tabs.decode"):"Base64 to Image"}),e.jsx("button",{onClick:()=>a("encode"),className:`flex-1 p-4 text-lg font-semibold transition-colors duration-200 ${i==="encode"?"bg-blue-500 text-white":"bg-transparent text-gray-600 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700"}`,children:t?s("converter.tabs.encode"):"Image to Base64"})]}),i==="decode"&&e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"relative",children:[e.jsx("textarea",{ref:A,className:"w-full h-32 p-4 border border-gray-300 dark:border-gray-600 rounded-lg bg-gray-50 dark:bg-gray-700 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition",placeholder:t?s("converter.actions.paste"):"Paste Base64 encoding here...",value:n,onChange:X,onPaste:Y,disabled:S}),S&&e.jsx("div",{className:"absolute inset-0 bg-white/80 dark:bg-gray-800/80 rounded-lg flex items-center justify-center",children:e.jsxs("div",{className:"flex items-center gap-2 text-blue-600 dark:text-blue-400",children:[e.jsx("div",{className:"w-4 h-4 border-2 border-blue-600 border-t-transparent rounded-full animate-spin"}),e.jsx("span",{className:"text-sm font-medium",children:t?s("converter.messages.processingText"):"处理大型文本中..."})]})})]}),w&&e.jsxs("div",{className:"mt-2 flex items-center justify-between text-xs text-gray-500 dark:text-gray-400",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("span",{children:[t?s("converter.stats.length"):"长度",": ",w.length.toLocaleString()," ",t?s("converter.stats.characters"):"字符"]}),e.jsxs("span",{children:[t?s("converter.stats.size"):"大小",": ~",w.sizeKB," KB"]}),w.isLarge&&e.jsx("span",{className:"px-2 py-1 bg-yellow-100 dark:bg-yellow-900 text-yellow-800 dark:text-yellow-200 rounded text-xs",children:t?s("converter.stats.largeText"):"大型文本"})]}),w.isLarge&&e.jsxs("div",{className:"text-xs text-blue-600 dark:text-blue-400",children:["💡 ",t?s("converter.stats.optimizedHint"):"提示：大型文本使用优化处理"]})]}),e.jsxs("div",{className:"flex flex-wrap gap-3 mt-4",children:[e.jsx("button",{onClick:H,disabled:u||S,className:"flex-1 px-6 py-3 bg-blue-600 text-white font-semibold rounded-lg hover:bg-blue-700 disabled:bg-gray-400 transition-colors duration-200",children:u?t?s("converter.labels.loading"):"Processing...":t?s("converter.actions.decode"):"Convert to Image"}),e.jsx("button",{onClick:te,disabled:!d,className:"flex-1 px-6 py-3 bg-green-600 text-white font-semibold rounded-lg hover:bg-green-700 disabled:bg-gray-400 transition-colors duration-200",children:t?s("converter.actions.downloadImage"):"Download Image"})]})]}),i==="encode"&&e.jsx("div",{className:"p-6",children:e.jsxs("div",{onDrop:ee,onDragOver:Q,onDragLeave:Z,onClick:()=>L.current?.click(),className:`border-2 border-dashed rounded-lg p-8 text-center cursor-pointer transition-colors duration-200
                ${k?"border-blue-500 bg-blue-50 dark:bg-blue-900/20":"border-gray-300 dark:border-gray-600 hover:border-blue-400"}`,children:[e.jsx("input",{type:"file",ref:L,onChange:G,className:"hidden",accept:"image/*"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:t?s("converter.labels.dropzone"):"Drag and drop image here, or click to select file"}),y&&e.jsxs("div",{className:"text-sm text-gray-600 dark:text-gray-300 bg-gray-100 dark:bg-gray-700 rounded-lg p-2 inline-block",children:[e.jsxs("div",{children:["📁 ",y.name]}),e.jsxs("div",{children:["📊 ",y.size," • ",y.type]})]})]})]})}),(d||h)&&e.jsxs("div",{className:"p-4 border-t border-gray-200 dark:border-gray-700 bg-gray-50 dark:bg-gray-800/50",children:[d&&i==="decode"&&e.jsxs(e.Fragment,{children:[e.jsx("h3",{className:"text-lg font-semibold mb-3 text-gray-800 dark:text-white",children:t?s("converter.labels.resultTitle"):"Conversion Result"}),e.jsx("div",{className:"mb-3 p-3 border rounded-lg bg-white dark:bg-gray-700",children:e.jsx("img",{src:d,alt:"Converted from Base64",className:"max-w-full mx-auto rounded"})})]}),h&&i==="encode"&&e.jsxs(e.Fragment,{children:[e.jsx("h3",{className:"text-lg font-semibold mb-3 text-gray-800 dark:text-white",children:t?s("converter.labels.outputTitle"):"Base64 Output"}),e.jsx("div",{className:"mb-3",children:e.jsx("textarea",{readOnly:!0,value:h,className:"w-full h-24 p-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-sm"})}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsx("button",{onClick:re,className:"px-4 py-2 bg-indigo-600 text-white font-medium rounded-lg hover:bg-indigo-700 transition-colors duration-200 text-sm",children:t?s("converter.actions.copy"):"Copy"}),e.jsx("button",{onClick:se,className:"px-4 py-2 bg-gray-600 text-white font-medium rounded-lg hover:bg-gray-700 transition-colors duration-200 text-sm",children:t?s("converter.actions.downloadTxt"):"Download as TXT"})]})]})]})]})]})}export{fe as default};
